extends ../../layouts/default.pug
include ../../mixins/alert.pug

block main
  +alert-success(message)
  +alert-error(message)

  .container-fluid
    .row
      .col-md-8.offset-md-2
        .card.shadow-sm
          .card-header.bg-warning.text-white
            h5.mb-0 Chá»‰nh Sá»­a BÃ i BÃ¡o

          form(method='POST', action=`/admin/articles/edit/${article._id}?_method=PATCH`, enctype='multipart/form-data')
            .card-body
              
              // ğŸ“Œ TiÃªu Äá»
              .mb-3
                label.form-label(for='title') TiÃªu Äá» *
                input.form-control(
                  type='text', 
                  name='title', 
                  id='title', 
                  value=article.title,
                  required
                )

              // ğŸ“Œ MÃ´ Táº£ Ngáº¯n
              .mb-3
                label.form-label(for='summary') MÃ´ Táº£ Ngáº¯n
                textarea.form-control(
                  name='summary', 
                  id='summary', 
                  rows='2'
                ) #{article.summary}

              // ğŸ“Œ Ná»™i Dung
              .mb-3
                label.form-label(for='content') Ná»™i Dung *
                textarea.form-control.tinymce-app(
                  name='content', 
                  id='content', 
                  rows='5',
                  required
                ) #{article.content}

              // ğŸ“Œ áº¢nh Thumbnail
              .mb-3
                label.form-label(for='thumbnail') áº¢nh Thumbnail
                input.form-control(
                  type='file', 
                  name='thumbnail', 
                  id='thumbnail', 
                  accept='image/*'
                )
                if article.thumbnail
                  img.img-thumbnail.mt-2#thumbnail-preview(src=article.thumbnail, alt='Thumbnail', style='max-width: 200px;' thumbnail-preview)

              // ğŸ“Œ Tráº¡ng ThÃ¡i
              .mb-3
                label.form-label(for='status') Tráº¡ng ThÃ¡i
                select.form-select(name='status', id='status')
                  option(value='active' selected=article.status === 'active') Hoáº¡t Äá»™ng
                  option(value='inactive' selected=article.status === 'inactive') KhÃ´ng Hoáº¡t Äá»™ng

              // ğŸ“Œ NÃºt HÃ nh Äá»™ng
              .text-end
                button.btn.btn-success(type='submit') LÆ°u Thay Äá»•i
                a.btn.btn-secondary.ms-2(href='/admin/articles') Há»§y

  // ğŸ‘‰ Script Preview áº¢nh Thumbnail
  script.
    document.getElementById('thumbnail').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const preview = document.getElementById('thumbnail-preview');

      if (file) {
        const reader = new FileReader();

        reader.onload = function(e) {
          preview.src = e.target.result;
          preview.classList.remove('d-none');
        };

        reader.readAsDataURL(file);
      } else {
        preview.src = '';
        preview.classList.add('d-none');
      }
    });
