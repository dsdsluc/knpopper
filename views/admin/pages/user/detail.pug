extends ../../layouts/default.pug
include ../../mixins/alert.pug

block main
  +alert-success(message)
  +alert-error(message)

  .row
    .col-xl-12
      .card.shadow-sm
        .card-header.bg-primary.text-white.d-flex.justify-content-between.align-items-center
          h4 Chi Ti·∫øt Ng∆∞·ªùi D√πng
          a.btn.btn-light.btn-sm(href='/admin/users') ‚Üê Quay L·∫°i

        .card-body
          .row
            .col-md-4.text-center
              if user.avatar
                img.img-thumbnail.rounded-circle(src=`${user.avatar}`, alt='Avatar', width='150', height='150')
              else
                img.img-thumbnail.rounded-circle(src='/images/default-avatar.png', alt='Avatar', width='150', height='150')
              h5.mt-2 #{user.fullName || 'N/A'}
              span.badge(class=`bg-${user.status === 'active' ? 'success' : user.status === 'inactive' ? 'warning' : 'danger'}`) #{user.status}

            .col-md-8
              dl.row
                dt.col-sm-4 Email:
                dd.col-sm-8 #{user.email || 'N/A'}

                dt.col-sm-4 S·ªë ƒêi·ªán Tho·∫°i:
                dd.col-sm-8 #{user.phone || 'N/A'}

                dt.col-sm-4 ƒêiÃ£a chiÃâ:
                dd.col-sm-8 #{user.address || 'N/A'}
                
                dt.col-sm-4 Th√†nh Ph·ªë:
                dd.col-sm-8 #{user.city || 'N/A'}

                dt.col-sm-4 T·ªïng Chi Ti√™u:
                dd.col-sm-8 #{stats.totalSpent.toLocaleString()} VNƒê

        .card-footer.text-end
          a.btn.btn-warning.btn-sm(href=`/admin/users/edit/${user._id}`) ‚úèÔ∏è Ch·ªânh S·ª≠a
          button.btn.btn-danger.btn-sm(ms-2 onclick=`confirmDeleteUser('${user._id}')`) üóëÔ∏è X√≥a Ng∆∞·ªùi D√πng

      .card.mt-4
        .card-header.bg-secondary.text-white
          h5 Th·ªëng K√™ ƒê∆°n H√†ng

        .card-body
          ul.list-group
            li.list-group-item T·ªïng ƒê∆°n H√†ng: #{orders.length}
            li.list-group-item ƒê∆°n ƒêang Ch·ªù: #{stats.pending}
            li.list-group-item ƒê∆°n ƒêang Giao: #{stats.delivering}
            li.list-group-item ƒê∆°n Ho√†n Th√†nh: #{stats.completed}
            li.list-group-item ƒê∆°n ƒê√£ H·ªßy: #{stats.canceled}

      .card.mt-4
        .card-header.bg-info.text-white
          h5 Danh S√°ch ƒê∆°n H√†ng

        .card-body
          if orders.length > 0
            table.table.table-bordered.table-hover
              thead
                tr
                  th M√£ ƒê∆°n H√†ng
                  th Tr·∫°ng Th√°i
                  th T·ªïng Gi√°
                  th Ng√†y T·∫°o
                  th H√†nh ƒê·ªông

              tbody
                each order in orders
                  tr
                    td #{order._id}
                    td 
                      span.badge(class=`bg-${order.status === 'completed' ? 'success' : order.status === 'pending' ? 'warning' : 'danger'}`) #{order.status}
                    td #{order.totalPrice.toLocaleString()} VNƒê
                    td #{new Date(order.createdAt).toLocaleString()}
                    td
                      a.btn.btn-primary.btn-sm(href=`/admin/order/detail/${order._id}`) Chi Ti·∫øt
          else
            p.text-muted Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o.
